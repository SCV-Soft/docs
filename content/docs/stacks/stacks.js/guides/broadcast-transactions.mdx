---
title: Broadcast transactions
description: Create and broadcast transactions to the Stacks blockchain network using Stacks.js.
---

import { Badge } from '@/components/ui/badge';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';

import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';
import { ChevronRight, Code, Terminal } from 'lucide-react';
import { File, Folder, Files } from 'fumadocs-ui/components/files';
import { Step } from 'fumadocs-ui/components/steps';
import { TypeTable } from 'fumadocs-ui/components/type-table';

import { GridPattern } from "@/components/grid-pattern";
import { ConnectWalletButton } from '@/components/code/connect-wallet-button';

import { InlineCode } from '@/components/inline-code';

The process of broadcasting transactionsis fundamental for interacting with blockchains, whether you're transferring tokens, deploying contracts, or executing contract functions.

In this guide, you will learn how to:

1. Install the necessary packages for building and broadcasting transactions
2. Build different types of transactions
3. Sign and broadcast those transactions to the Stacks blockchain
4. Process and handle the results

The examples in this guide are designed to be minimalistic, allowing you to easily adapt and customize these examples to fit your application's specific needs.

<Callout title="Example Repo">To see this guide in action, check out a full example [here](https://github.com/hiro-so/stacks-connect-example).</Callout>

---

### Setup and installation

Install the required packages to start building and broadcasting transactions.

```package-install
@stacks/network @stacks/transactions @stacks/connect
```

- **@stacks/network**: Used to interact with the Stacks blockchain network.
- **@stacks/transactions**: Used to build the transactions.
- **@stacks/connect**: Used to authenticate users and broadcast the transactions.

### Create a transaction

There are three types of transactions:

- STX transfer
- Contract deployment
- Contract execution

<Tabs defaultValue="transfer">
  <TabsList className='flex flex-wrap md:w-max'>
    <TabsTrigger value="transfer" className='tab group'>
      <Badge variant='outline' className='badge transition-colors hover:text-neutral-90 dark:group-hover:text-white'>STX transfer</Badge>
    </TabsTrigger>
    <TabsTrigger value="deploy" className='tab group'>
      <Badge variant='outline' className='badge transition-colors hover:text-neutral-90 dark:group-hover:text-white'>Contract deployment</Badge>
    </TabsTrigger>
    <TabsTrigger value="execute" className='tab group'>
      <Badge variant='outline' className='badge transition-colors hover:text-neutral-90 dark:group-hover:text-white'>Contract execution</Badge>
    </TabsTrigger>
  </TabsList>
  <TabsContent value="transfer">
    To prompt the user to transfer STX, call the `openSTXTransfer` function provided by the `@stacks/connect` package to trigger the display of a transaction signing prompt for transferring STX:

    ```ts twoslash
    // @noErrors
    import { openSTXTransfer } from '@stacks/connect';
    import { StacksTestnet } from '@stacks/network';

    openSTXTransfer({
      recipient: 'ST2EB9WEQNR9P0K28D2DC352TM75YG3K0GT7V13CV',
      amount: '100',
      memo: 'Reimbursement',
      network: new StacksTestnet(), // for mainnet, `new StacksMainnet()`
      appDetails: {
        name: 'My App',
        icon: window.location.origin + '/my-app-logo.svg',
      },
      onFinish: data => {
        console.log('Stacks Transaction:', data.stacksTransaction);
        console.log('Transaction ID:', data.txId);
        console.log('Raw transaction:', data.txRaw);
      },
    });
    ```

    Several parameters are available for calling openSTXTransfer. To learn more, check out our [reference page](/stacks/stacks.js/packages/connect).

  </TabsContent>
  <TabsContent value="deploy">
    ```package-install
    @stacks/network
    ```

    Network and API library for working with Stacks blockchain nodes.
  </TabsContent>
  <TabsContent value="execute">
    ```package-install
    @stacks/transactions
    ```

    Construct, decode transactions and work with Clarity smart contracts on the Stacks blockchain.
  </TabsContent>
</Tabs>

```ts twoslash
// @noErrors
import { makeSTXTokenTransfer } from '@stacks/transactions';

const transaction = await makeSTXTokenTransfer({ recipient: 'SP3FGQ...SK2T', amount: new BN(123), senderKey: 'your-private-key' });
```
This creates a STX token transfer transaction. The `makeSTXTokenTransfer` function takes parameters like the recipient's address, amount to transfer, and the sender's private key.

### Sign and broadcast the transaction

Prompt the user to sign the transaction using the `showConnect` function from the `@stacks/connect` package.

<div className="not-prose relative bg-[#F9F9FA] rounded-xl overflow-hidden dark:bg-[#191919]">
  <div className="absolute inset-0 bg-[#F9F9FA] dark:bg-[#191919]"></div>
  <div className="relative rounded-xl overflow-auto p-8">
    <div className="grid place-items-center">
      <ConnectWalletButton />
      <GridPattern />
    </div>
  </div>
  <div className="absolute inset-0 pointer-events-none border border-black/5 rounded-xl dark:border-white/5"></div>
</div>

```ts twoslash
// @noErrors
import { showConnect } from '@stacks/connect';

showConnect({
  appDetails: {
    name: 'My App',
    icon: window.location.origin + '/my-app-logo.svg',
  },
  onFinish: (data) => {
    console.log('Transaction signed!', data.txRaw);
  },
  userSession,
});
```

This function triggers a UI popup that asks the user to sign the transaction. The onFinish callback is executed once the transaction is signed, providing access to the raw transaction data.

### Broadcasting the transaction

After building the transaction, broadcast it to the Stacks blockchain network using the `sendTransaction` function from the `@stacks/network` package.

1. Check if there is a pending sign-in using the `isSignInPending` method of the `userSession` object.
2. If there is a pending sign-in, handle it by calling `handlePendingSignIn` which processes the sign-in and then utilizes the `userData` returned in a promise.

```tsx twoslash
// @noErrors
import { broadcastTransaction } from '@stacks/transactions';

const broadcastResponse = await broadcastTransaction(transaction);
console.log('Transaction ID:', broadcastResponse.txid);
```

This code sends the signed transaction to the Stacks blockchain. The broadcastTransaction function returns a response containing the transaction ID, which can be used to track the transaction on the blockchain.

### Handle the results

Handle the transaction results by checking the transaction status and responding accordingly.

```ts twoslash
// @noErrors
if (broadcastResponse.success) {
  console.log('Transaction successful with ID:', broadcastResponse.txid);
} else {
  console.error('Transaction failed with error:', broadcastResponse.error);
}
```

This checks if the transaction was successful and logs the result. It handles both success and error states, providing feedback based on the transaction outcome.

---

### Next steps

<Cards>
  <Card
    icon={<Code className='text-primary' />}
    href="/stacks/stacks.js/guides/broadcast-transactions"
    title="Broadcast transactions"
    description="Learn how to interact with your smart contracts using Stacks.js."
  />
  <Card
    icon={<Terminal className='text-primary' />}
    href="/stacks/stacks.js/guides/deep-dive-into-post-conditions"
    title="Deep dive into post-conditions"
    description="Learn how to use post-conditions to secure your smart contracts."
  />
</Cards>

